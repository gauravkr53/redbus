<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Bookings - RedBus</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <h1>RedBus</h1>
            </div>
            <div class="nav-links">
                <a href="/search">Search Buses</a>
                     <a href="/bookings/upcoming-trips" class="active">My Bookings</a>
                <a href="/logout" class="btn-logout">Logout</a>
            </div>
        </div>
    </nav>

    <div class="container">
        <div class="page-header">
            <h2>My Upcoming Trips</h2>
            <p>Manage your booked trips and view booking details</p>
        </div>

        <div class="upcoming-trips-section">
            <div th:if="${upcomingTrips != null and !upcomingTrips.isEmpty()}" class="trips-list">
                <div th:each="trip : ${upcomingTrips}" class="trip-card">
                    <div class="trip-header">
                        <h3>Booking ID: <span th:text="${trip.bookingId}">BOOKING123</span></h3>
                        <span class="status-badge confirmed">Confirmed</span>
                    </div>
                    
                    <div class="trip-details">
                        <div class="trip-route">
                            <div class="route-info">
                                <div class="city-info">
                                    <h4 th:text="${trip.sourceCityId}">Source City</h4>
                                    <p class="time" th:text="${trip.createdAt}">Booking Date</p>
                                </div>
                                <div class="route-arrow">â†’</div>
                                <div class="city-info">
                                    <h4 th:text="${trip.destCityId}">Destination City</h4>
                                    <p class="date" th:text="${trip.date}">Travel Date</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="trip-summary">
                            <div class="summary-item">
                                <span class="label">Trip ID:</span>
                                <span th:text="${trip.tripId}">TRIP001</span>
                            </div>
                            <div class="summary-item">
                                <span class="label">Status:</span>
                                <span class="status" th:classappend="${trip.status.name() == 'RESERVED'} ? 'status-reserved' : 'status-confirmed'" th:text="${trip.status.name()}">CONFIRMED</span>
                            </div>
                            <div class="summary-item">
                                <span class="label">Seats:</span>
                                <span th:text="${trip.seats}">2</span>
                            </div>
                            <div class="summary-item">
                                <span class="label">Total Amount:</span>
                                <span class="price">â‚¹<span th:text="${#numbers.formatDecimal(trip.pricePaise / 100, 1, 2)}">0.00</span></span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="trip-actions">
                        <button class="btn-secondary" onclick="window.print()">Print Ticket</button>
                        <button class="btn-primary" th:data-booking-id="${trip.bookingId}" onclick="viewBooking(this.dataset.bookingId)">View Details</button>
                    </div>
                </div>
            </div>
            
            <div th:if="${upcomingTrips == null or upcomingTrips.isEmpty()}" class="empty-state">
                <div class="empty-icon">ðŸ“‹</div>
                <h3>No Upcoming Trips</h3>
                <p>You don't have any confirmed bookings yet.</p>
                <a href="/search" class="btn-primary">Search for Buses</a>
            </div>
        </div>
    </div>

    <script th:src="@{/js/app.js}"></script>
    <script>
        function viewBooking(bookingId) {
            // In a real app, this would navigate to a detailed booking view
            alert('Booking details for: ' + bookingId + '\n\nThis feature would show detailed booking information, seat numbers, and trip details.');
        }
    </script>
</body>
</html>
